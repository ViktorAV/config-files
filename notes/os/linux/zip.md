# Архивация и резервное копирование Linux
Сжатие данных - это процесс устранения избыточных данных.
Архивирование это процесс сбора файлов и упаковывания их в один файл.
Сжатие осуществляется двумя методами
- Без потерь, гарантирует сохранность файлы
- С потерями, файл уже не будет оригинальным, но сжатие будет эффективным.
__Программы__
- `gzip` сжимает и распаковывает файлы
- `bzip2` сжимает файлы поблочно
- `tar` архивирование
- `zip` упаковывает и сжимает файлы
- `rsync` синхронизация файлов удалённо

## gzip bzip2
Программа gzip используется для сжатия и распаковки одного или
нескольких файлов, она замещает оригинальный файл его сжатой версией.
Программа gunzip используется для распаковки сжатых файлов.
Синтаксис `gzip file.txt` `gunzip file.txt`

Программа bzip2 похожа на gzip, но использует иной алгоритм, который
обеспечивает более высокую степень сжатия, ценой скорости работы.
Программа bzip2recover восстанавливает файлы bzip2.
__Параметры gzip__
| Параметр | Описание                                           |
|----------|----------------------------------------------------|
| -c       | Выводит результат и сохраняет оригинальные файлы   |
| -d       | Распаковывает файл (действует как gunzip)          |
| -f       | Принудительное сжатие (даже если сжатый файл сущ.) |
| -h       | Выводит справку                                    |
| -l       | Выводит список статистик для каждого файла         |
| -r       | Рекурсивное сжатие                                 |
| -t       | Проверяет целостность каждого файла                |
| -v       | Verbose, выводит информацию о своей работе         |
| -1       | Степень сжатия от 1 до 9 (по умолчанию 6)          |

## tar
Программа tar используется для архивирования файлов (tape archive)
Если выполнить разархивирование не от имени суперпользователя, все
файлы будут принадлежать пользователю выполнившему разархивирование.
Синтаксис `tar режим(параметры) путь`
Режимы tar
- `c` Создать архив
- `x` Извлечь архив
- `r` Добавить в конец архива
- `t` Вывести содержимое
Архивирование папки
`tar cf my.tar dir`
Разархивирование
`tar xf my.tar`
Разархивирование отдельного файла внутри архива
`tar xf my.tar path_to_file`
Архивирование используя find
`find dir -name 'file' -exec tar rf my.tar '{}' '+'`
`find dir -name 'file' | tar cf - --files-from=- | gzip > my.tgz`

## zip
Программа zip является и инструментом сжатия и архиватором.
Программа unzip извлекает файлы из архива.
Синтаксис `zip параметры сжатый_файл файл`
Создание zip архива, с рекурсивным обходом
`zip -r my.zip dir`

## rsync
Программа rsync (remote sync) полезна для синхронизации файлов на
удалённой или локальной системе, но источник либо приёмник должен
находится на локальной машине. Также можно использовать как демон.
Приёмником и источником могут быть
- Локальный файл или каталог
- Удалённый файл или каталог `user@host:path`
- Удалённый сервер rsync URI `rsync://user@host:port/path`
Можно например сделать копию веб-сайта находящегося в разработке на
локальной системе и синхронизировать её с удалённой.
Синтаксис `rsync параметры источники приёмник`
- `dir/*` Синхронизирует содержимое, без скрытых файлов
- `dir/` Синхронизирует содержимое каталога
- `dir` Синхронизирует каталог
__Параметры__
- `-a` Архивирование, рекурсивный обход и сохранение атрибутов файла.
- `-v` Подробный вывод
- `--rsh=ssh` Использовать передачу файлов по SSH
- `rsync://` Синхронизация по серверу rsync

Синхронизация двух локальных каталогов
`rsync -a dir_sync_target dir2`
Несколько каталогов, с удалением существующих копий файлов в dir
`rsync -a --delete /etc /home /usr/local dir`
ssh
`rsync -a --rsh=ssh /etc /home host:/backup`
Сервер URI
`rsync -av --delete rsync://archive.linux/fedora fedora-devel`
