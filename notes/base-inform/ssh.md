# Подключение по SSH
SSH (Secure Shell) - сетевой протокол прикладного уровня, предназначенный для безопасного 
удалённого доступа к различным ОС (Windows, Linux, Mac)
Данный протокол шифрует всю передаваемую информацию по сети.
Работа SSH построена на взаимодействии 2-х компонентов:
- SSH-сервер.
  По умолчанию прослушивает соединения на порту 22.
  Требует аутентификации сторон:
    - Пароль.
      Используется чаще всего. Между клиентом и сервером создаётся общий ключ.
    - Пара ключей.
      Предварительно генерируется открытый и закрытый ключ.
      На устройстве с которого нужно подключиться хранится закрытый ключ.
      А на сервере - открытый ключ.
    - IP-адрес.
      Не безопасный.
- SSH-клиент.
  Используется для входа на удалённый сервер и выполнения команд.

OpenSSH (Open Secure Shell) - это набор программ, который позволяет шифровать сеансы подключений.
- ssh
- scp
- sftp
- sshd
- sftp-server
- ssh-keygen
- ssh-keysign
- ssh-keyscan
- ssh-agent
- ssh-add

## Установка SSH и Open-SSH
```bash
sudo apt install ssh
sudo apt install openssh-server
```
Убедимся что служба `sshd` запущена
```bash
systemctl status sshd
# Состояние Active: active (running) говорит о том что служба работает
```
Включаем службу `sshd`
```bash
sudo systemctl enable sshd
```
Отключим брандмауэр, для того чтобы исключить блокировку входящих подключений
```bash
sudo ufw disable
```
В целях безопасности стандартный порт SSH лучше изменить
Открываем файл `/etc/ssh/sshd_config`
```bash
Port 3004
```
После изменения перезапускаем службу командой `systemctl restart sshd`.

## Подключение по SSH
Подключение выполняется командой `ssh`, с аргументами имя пользователя и IP-адрес.
Узнать IP-адрес для подключения можно командой `ip address show`.
```bash
ssh trac@192.168.0.1
```
При первом подключении предложит добавить публичный ключ сервера в локальную базу.
После чего вводится пароль пользователя от имени которого выполняется подключение.

## Настройка подключения по ключу
Генерируем приватный и публичный ключ командой `ssh-keygen`
```bash
ssh-keygen
```
По умолчанию генерирует два ключа в каталог `~/.ssh`.
На сервере в файл `~/.ssh/authorized_keys` необходимо скопировать содержимое публичного ключа.
Либо воспользоваться утлитой `ssh-copy-id`, которая скопирует публичный ключ на сервер
```bash
ssh-copy-id user@192.168.0.1
```
После выполнения этих действий, пароль запрашиваться не будет.
